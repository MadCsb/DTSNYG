<!DOCTYPE html>
<html>
<head>
	<#include "WAP_INC_HEAD.html">
		<style>
			.snyg_xccon p { margin-bottom:6px;}
		</style>
</head>
<body style="background:#f6f6f8;">
<input type="hidden" name="loginPage" value="${loginPage!'wap'}">
<div><img src="wap/images/logobg.jpg" width="100%"></div>
<div class="snyg_content">
	<h2 align="center" style="margin-top:12px;">用户注册</h2>
	<div class="snyg_xccon" style="background:transparent;">
		<p><input id="userLoginName" class="txt-input xm" type="text" placeholder="请输入用户名"></p>
		<p><input id="userPwd" class="txt-input mm1" type="password" placeholder="请输入密码"></p>
		<p><input id="userNewPwd" class="txt-input mm1" type="password" placeholder="请确认密码"></p>

		<p style="position:relative;">
			<input id="securityCode" class="txt-input yzm" type="text" placeholder="请输入验证码">
			<span style=" position:absolute;top:4px; right:0;">
     		<img src="${rc.contextPath}/verify_code.jsp" id="picsss" title="更换验证码" onClick="replaceCode()">
			</span>
		</p>
		<label class="labelboxn">
			<input id="isOk" type="checkbox">我同意
		</label>
		<a onClick="openArticle()">《三农壹购平台注册协议》 </a>
		<div class="f2">
			<span style="vertical-align: middle; margin-left:10px;" id="errorMsg"></span></div>
	</div>
</div>
<a onclick="toZhuce()"><div align="center"><button class="btn-big"  style="width:80%; margin-top:0;">注册</button></div></a>

<a href="tologin?loginPage=${loginPage!'wap'}"><div align="center">我要登录</div></a>
	<script>
    function toZhuce() {
      if( !$("#isOk").is(":checked"))
      {
        $("#errorMsg").html("请同意《三农壹购平台注册协议》");
        return false;
      }
      var userLoginName = $("#userLoginName").val();
      var userPwd = $("#userPwd").val();
      var userNewPwd = $("#userNewPwd").val();
      var securityCode = $("#securityCode").val();
      $.ajax({
        type: "POST",
        url: "newUser",
        dataType:"json",
        data: {
          userLoginName: userLoginName,
          userPwd: userPwd,
          userNewPwd: userNewPwd,
          securityCode: securityCode
        },
        success: function (data) {
          if(data.resultCode == '0')
          {
            window.location.href = "wappersonal.do?method=toPersonal";
          }else
          {
            $("#errorMsg").html(data.resultMsg);
            replaceCode()
          }
        }
      })
    }

		//点击更换验证码
		function replaceCode()
		{
			d = new Date().getTime();
			document.getElementById('picsss').src = '${rc.contextPath}/verify_code.jsp?a=' + d;
		};
		function openArticle() {
      var articleId = "4ff9d989845b4fddaf3200dcd01e5367";
      var url = 'webArticle?method=toArticleContext&articleId=' + articleId;
      window.open(url);
    }
	</script>
</div>
</body>
</html>