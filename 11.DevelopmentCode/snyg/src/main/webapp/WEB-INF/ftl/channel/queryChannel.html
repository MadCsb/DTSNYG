<!DOCTYPE html>
<html>
<head>
<#include "/INC_HEAD.html">
<meta charset="utf-8" />
</head>
<body>

	<form id="queryFrm" action="channel?method=query"
		method="post">
       	<input type="hidden" id="entityPage.currentPage" name="entityPage.currentPage"  value="${pageInfo.pageNum!''}" />
		<input type="hidden" id="entityPage.sortField" name="entityPage.sortField" value="${entityPage.sortField!''}" /> 
		<input type="hidden" id="entityPage.sortOrder" name="entityPage.sortOrder" value="${entityPage.sortOrder!''}" />
		
		<div class="data-requry">
		<table border="0" align="left" cellpadding="0" cellspacing="0">
		<tr>
        	<td>渠道名称：
				<input autocomplete="off"   name="channelName" type="text" class="data-searchtxt" id="channelName" value="${channel.channelName!''}">
			</td>
		</tr>
		</table>
      		<input name="button" type="submit" class="data-searchbtn" id="button" value="查询"/>
		</div>
		
		<div class="cont-div">
 			 <div class="waybill-title">
  				<div align="left">
     				<input name="button5" id="button5" type="button" class="cbtn1"  
		           			value="新增" onClick="javascript:window.location.href='channel.do?method=toAdd'">
    			</div>
  			 </div>
  		</div>
		
  		<table width="100%" border="0" cellspacing="0" cellpadding="0" class="datalist" id="changecolor">
        <tr>
	        <th width="28%">渠道名称</th>
	        <th width="16%">渠道状态 </th>
	        <th width="8%">渠道标识</th>
	        <th width="12%">渠道描述 </th>
	        <th width="12%">操作</th>
        </tr>
        <#if channellist?? && (channellist?size>0)>
        <#list channellist as li>  
        	<tr onclick="selectTr(this)">
        		<td title="${li.channelName!''}">${li.channelName!''}</td>
        		<td title="<#if li.status=='0'>
       				禁用
       			<#else>
       				启用
       			</#if>   ">
        		<#if li.status=='0'>
       				禁用
       			<#else>
       				启用
       			</#if>   
        		</td>
        		<td title="${li.channelKey!''}">${li.channelKey!''}</td>
        		<td title="${li.channelDesc!''}">${li.channelDesc!''}</td>
        		<td title=""> 
        			<#if li.isSys=='0'>
        			<#if li.status=='0'>
        				<a href="javascript:void(0)" title="启用" onclick="changeStatus('${li.channelId!''}','${li.status!''}')" class="ico_btn1">启用</a>
        				<a href="saleType?method=toUpdate&saleTypeId=${li.saleTypeId!''}" title="编辑" class="ico_btn1">编辑</a>
        			<#else>
        				<a href="javascript:void(0)" title="禁用" onclick="changeStatus('${li.channelId!''}','${li.status!''}')" class="ico_btn1">禁用</a> 
        			</#if>    	
        			</#if>		
        			<a href="javascript:void(0)" title="绑定活动" onclick="bindSaleType('${li.channelId!''}')" class="ico_btn1">绑定活动</a> 
  				</td>
        	</tr>
        </#list>
  	    </#if> 
        </table>
		
		<div class="page-div">
 			<#if channellist?? && (channellist?size>0)>   
       			<#include "/pagination.html">
  			<#else>
  				<div id='ListIsNullMsg' style="font-size:17px;color:red"><script type="text/javascript">showListIsNullMsg();</script></div>
  			</#if>
      	</div>
		
	</form>
	<form action="company?method=deleteBatch" id="deleteBatch"
		method="post">
		<input type="hidden" name="checkedCompanyIds"
			id="checkedCompanyIds">
	</form>
<script type="text/javascript">
$(function(){
	// 初始化全选复选框
	initCheckBox('allcheck', 'delId');
});

function changeStatus(channelId,status){
	var info = "";
	if(status=="0"){
		info = "确认要启用这条记录吗？";
		status = 1;
	}else if(status=="1"){
		info = "确认要禁用这条记录吗？";
		status = 0;
	}
	parent.layer.confirm(info, function() {
		$.post("channel?method=updateChannelStatus",{
			channelId:channelId,
			status:status
		},function(data){
			parent.layer.alert(data.resultMsg,function(){
				$("#queryFrm").submit();
				parent.layer.closeAll();
			});
		},'json')
	}, function() {
		parent.layer.closeAll();
	});
	 
}
//绑定活动
function bindSaleType(channelId){
	art.dialog.data("channelId",channelId);
	parent.layer.open({
		type : 2,
		title : '选择活动',
		area : [ '500px', '300px' ],
		fix : true,
		content :"saleType?method=queryForBind",
		end: function(){
			
		}
	});
}
</script>
</body>
</html>