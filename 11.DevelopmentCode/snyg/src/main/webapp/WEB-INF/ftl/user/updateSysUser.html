<!DOCTYPE html>
<html>
<head>
<#include "/INC_HEAD.html">

</head>      

<body>
	<form action="updateUser" method="post" id="createUser">
	<input type="hidden" id="userId" name ="userId" value="${user.userId!''}">
	<input type="hidden" id="accId" name ="accId" value="${user.accId!''}">
	<input type="hidden" id="userState" name ="userState" value="${user.userState!''}">
	<input type="hidden" id="userLocked" name ="userLocked" value="${user.userLocked!''}">
	<input type="hidden" id="updatePassDate" name ="updatePassDate" value="${user.updatePassDate!''}">
	<input type="hidden" id="unitId" name ="unitId" value="${user.unitId!''}">
	
		<div class="waybill-title"><span>修改用户</span> 
			<!--  <#if entranceType?? && entranceType="1">
				<input name="button5" type="button"  class="data-menubtn2" id="button5" value="修改支付密码" onClick="toUpdatePayPWD();">
			</#if>-->
		</div>
        	<table class="datalist-new" cellpadding="0" cellspacing="0" border="0" width="100%">
            	<tbody>
                	<tr class="">
                    	<td width="18%" class="tdright"><b><span class="f2"><b>*</b></span>登录名：</b></td>
                       	<td width="35%">${user.userLoginName!''}</td>
                      	<td class="tdright" width="12%"><b><span class="f2"><b>*</b></span>密码：</b></td>
                       	<td width="35%">
                       		<input name="userPwd" type="password" class="validate[custom[pwdformat]] data-searchtxt" id="userPwd" style="width:218px;">
                       		<span class="f2">不改密码请留空</span>
                       	</td>
                   </tr>
                   <tr>
                   		<td class="tdright"><b><span class="f2"><b>*</b></span>姓名：</b></td>
                       	<td colspan="3">
                       		<input type="text" class="validate[required,maxSize[30],custom[onlyLetterNumber2]] data-searchtxt" id="userName" name="userName" value="${user.userName!''}" style="width:218px;">
                        </td>
                        <!-- 
                    	<td class="tdright"><b><span class="f2"><b></b></span>身份证号：</b></td>
						<td >
							<input name="cradNum" value="${user.cradNum!''}" type="text"  class="data-searchtxt validate[funcCall[idCardCheckExt]]" id="cradNum" style="width:218px;">
						</td> --> 	 	
                   </tr>
                   <tr>
                  		<td class="tdright"><b>固定电话：</b></td>
                        <td valign="top">
                        	<input name="userTel" type="text" class="validate[maxSize[20],custom[phone]] data-searchtxt" id="userTel" value="${user.userTel!''}" style="width:218px;">
                        </td>
                        <td class="tdright"><b><span class="f2"><b></b></span>手机号码：</b></td>
                        <td>
                        	<input name="userMobile" type="text" class="validate[maxSize[15],custom[mobile]] data-searchtxt"  id="userMobile" value="${user.userMobile!''}" style="width:218px;">
                        </td>	
                  </tr>
                  <tr>
                   		<td class="tdright"><b>电子邮箱：</b></td>
                        <td>
                        	<input name="userEmail" type="text" class="validate[maxSize[50],custom[email]] data-searchtxt" id="userEmail" value="${user.userEmail!''}" style="width:218px;">
                   		</td>	
                      	<td class="tdright"><b>联系地址：</b></td>
                      	<td>
                      		<input name="userAddr" type="text" class="validate[maxSize[255]] data-searchtxt" id="userAddr"  value="${user.userAddr!''}" style="width:218px;" >
                      		<input type="hidden" name="userRoleType"  id="userRoleType" value="${user.userRoleType!''}">
					  	</td>
                  </tr>
                   <tr>
                   	<#if entranceType?? && entranceType="1">
                   	<td class="tdright"><b>是否可以同时登录：</b></td>
                   		<td colspan="3">
                        	<select id="isSame" name="isSame" class="data-inputtxt-select" style="width:218px;">
       							<#if user.isSame?? >
       								<#if user.isSame=="1" >
       									<option  value="1" selected="selected">是</option>
       									<option  value="0" >否</option>
       								<#elseif user.isSame=="0" >
       									<option  value="1" >是</option>
       									<option  value="0" selected="selected">否</option>
       								</#if>
       							<#else>
       								<option  value="0" >否</option>
       								<option  value="1" >是</option>
       							</#if>
           					</select>
                   		</td>
                   	<#else>
                   	<td class="tdright"><b>是否可以同时登录：</b></td>
                   		<td >
                        	<select id="isSame" name="isSame" class="data-inputtxt-select" >
       							<#if user.isSame?? >
       								<#if user.isSame=="1" >
       									<option  value="1" selected="selected">是</option>
       									<option  value="0" >否</option>
       								<#elseif user.isSame=="0" >
       									<option  value="1" >是</option>
       									<option  value="0" selected="selected">否</option>
       								</#if>
       							<#else>
       								<option  value="0" >否</option>
       								<option  value="1" >是</option>
       							</#if>
           					</select>
                   		</td>
                   		<td class="tdright"><b>描述：</b></td>
                    	<td>
                        	<input name="userDesc" type="text" class="validate[maxSize[255]] data-searchtxt" id="userDesc" style="width:218px;" value="${user.userDesc!''}">
                        </td> 
					</tr>
					</#if>

				</tbody>
  		</table>

<div class="footerbtn">

	<input name="button4" type="button" class="cbtn2" id="button4" onclick="javascript:location.href='${Session.BACK_URL!""}'" value="取消">
	
	<input name="btnSave" type="button"  class="add-new" onclick="beforeSub();" id="btnSave" value="确定">


</div>
	</form>
<script type="text/javascript">
	$( function() {
		$("#createUser").validationEngine();
	});
	function beforeSub()
	{ 
		if($("#createUser").validationEngine('validate'))
	  	{   
			$("#createUser").submit();
		}
	}
	function bindUserRole(userRoleType){
		var uid= $("#unitId").val();
		art.dialog.open("bindUserRole?userRoleType="+userRoleType+"&userId="+$("#userId").val()+"&checkedUnitId="+uid, {
			lock: true,
			resize: false,
			drag: false,
			width: 800,
			height: 500,
			close: function() {
				var unitId = art.dialog.data("unitId");
				var unitName = art.dialog.data("unitName");
				if(null != unitId && unitId != "" && null != unitName && unitName != "" && userRoleType !="3"){
					$("#unitId").val(unitId);
					$("#unitName").val(unitName);
					art.dialog.data("unitId","");
					art.dialog.data("unitName","");
					$.ajax({
						type: "POST",
						url:"getUserDep",           
						dataType:'json',
						data: {'unitId' : unitId,'delFlag':'0'},
						success: function(data){           
							var depList = data.depList;
							if(depList != null && depList.length > 0){
								$("#storeId").html("");
								$("#storeId").append('<option value="">----请选择----</option>');	
								var length = depList.length;
								for(var i = 0; i < length; i++){
									$("#storeId").append('<option value="'+depList[i].depId+'">'+depList[i].depName+'</option>');
								}
							}
						}
					});
				}
				
			}
		});
	}
	function toUpdatePayPWD(){
		var userId = $("#userId").val()
		if( null == userId || "" == userId){
			return;
		}
		art.dialog.open("toUpdatePayPWD?userId="+userId, {
			lock: true,
			resize: false,
			drag: false,
			width: 800,
			height: 500,
			close: function() {
			}
		});
	}
	/*
	* 身份证验证（严格）*
	* @param field 需要验证的dom元素
	* @param rules 验证规则数组
		* 使用funcCall单独调用外部函数验证时无效，需要配合"required"规则一起使用，
		* 例：validate[required,funcCall[idCardCheckExt]]，
		* 也可以在返回错误信息前，通过rules.push('required')，向验证规则数组内添加必填验证。
	*/
	function idCardCheckExt(field, rules, i, op) {
		if(!identityCodeValid($(field).val().toUpperCase())) {
			if($(field).val() != "") {
				// rules.push('required');
				return "*身份证无效!";					
			}
		}
	}
	</script>

</body>
</html>
